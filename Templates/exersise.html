{% extends "layout.html"%}
{%block content%}
<br />
<br />
<br />
<main role="main">
    <div class="container marketing">

        <div class='row row-eq-height'>
            <div class='col-lg-4'>
                <h1 style="text-align: center;">Time Exersising:</h1>

            </div>

            <div class='col-lg-2'>
                <h1 style="text-align: center;">00:00</h1>

            </div>
            <div class='col-lg-4 ml-auto'>
                <h1 style="text-align: center;">Sets Completed:</h1>

            </div>
            <div class='col-lg-2'>
                <h1 style="text-align: center;">0</h1>

            </div>
        </div>
        <br />
        <br />
        <br />
        <hr class="featurette-divider">
        <br />
        <br />
        <br />
        <h2><a style="float: left;">Add Exersise</a>
            <svg class="bi bi-plus-circle" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg" style="float: right; color: #272727; cursor: pointer;"
                onclick="openNav()">
                <path fill-rule="evenodd" d="M8 3.5a.5.5 0 01.5.5v4a.5.5 0 01-.5.5H4a.5.5 0 010-1h3.5V4a.5.5 0 01.5-.5z"
                    clip-rule="evenodd" />
                <path fill-rule="evenodd" d="M7.5 8a.5.5 0 01.5-.5h4a.5.5 0 010 1H8.5V12a.5.5 0 01-1 0V8z"
                    clip-rule="evenodd" />
                <path fill-rule="evenodd" d="M8 15A7 7 0 108 1a7 7 0 000 14zm0 1A8 8 0 108 0a8 8 0 000 16z"
                    clip-rule="evenodd" />
            </svg>
        </h2>
        <br />
        <br />
        <br />
        <br />
        <h2 style="float: left;">Exersises Completed<h2>

                <br />
                <hr class="featurette-divider">
                <div id="myNav" class="overlay">
                    <p onclick="closeNav()"> <a href="javascript:void(0)" class="closebtn">&times;</a></p>

                    <div class="overlay-content">
                        <main role='main'>
                            <div class='container marketing'>
                                <h1 style=" text-align: center;">Add Exersise</h1>

                                <br />
                                <br />

                                <form id='searchForm'
                                    class="form-inline d-flex justify-content-center md-form form-sm mt-0"
                                    style="margin: 0; padding: 0;">

                                    <i class="fas fa-search fa-1x" style="color: white; float: left;"></i>
                                    <input id='searchBar' class="form-control form-control-sm ml-3 w-75" type="text"
                                        placeholder="Search" aria-label="Search"
                                        style="background-color: transparent; color: white;  border-bottom:1px solid white; font-size: 20px; display: inline;">

                                    &emsp14; <a
                                        onclick="getExersises.search(document.getElementById('searchBar').value)"
                                        class="btn btn-primary btn-primary"
                                        style=" border-radius: 10px;display: inline; background-color: #4f98ca; color: white; border: 1px solid #4f98ca;">Submit</a>
                                </form>
                                <h3 class='hide' style="text-align: center;" id='errorText'><br /><br /><br />Error
                                    While Searching, Try Again!</h1>
                                    <h3 class='hide' style="text-align: center;" id='noResults'><br /><br /><br />
                                        No Results, Search Again!</h1>

                                        <table class='table-borderless'
                                            style=" border: none; color: white; width: 100%;">
                                            <br />
                                            <br />
                                            <br />

                                            <tbody id='items' style="display: none;">

                                            </tbody>
                                        </table>
                            </div>



                    </div>
                </div>
    </div>
</main>
<script>
    let exersises = []
    let noIn = false;

    function openNav() {
        document.getElementById("myNav").style.width = "100%";

    }

    function closeNav() {
        document.getElementById("myNav").style.width = "0%";

    }
    async function getExersises() {

        let response = await axios.get('/api/exersises')
        for (i = 0; i <= 897; i++) {

            exersises.push(response.data[i].exercise)

        }
        async function search(term) {
            if (term.match(/^[a-z0-9]+$/i)) {
                try {
                    term = term.toLowerCase()
                    noIn = false;
                    let clearNoResults = $('#noResults').addClass('hide')
                    let clearError = $('#errorText').addClass('hide')
                    let clearResults = document.getElementById('items').innerHTML = ''
                    let query = await exersises.filter(item => item.toLowerCase().indexOf(term) > -1);
                    if (document.getElementById('searchBar').value === '') {
                        $('#noResults').removeClass()
                        noIn = true;
                    }
                    if (noIn == false) {
                        if (query.length >= 1) {
                            for (r = 0; r <= query.length - 1; r++) {

                                document.getElementById('items').innerHTML += '<tr><td>' + query[r] +
                                    '</td><td><input  class="form-control form-control-sm ml-3 "type="number"placeholder="hr" aria-label="Search"style="background-color: transparent; color: white; width:10%; border-bottom:1px solid white; display: inline;"><input  class="form-control form-control-sm ml-3 "type="number"placeholder="min" aria-label="Search"style="background-color: transparent; color: white; width:10%; border-bottom:1px solid white; display: inline;"><input  class="form-control form-control-sm ml-3 "type="number"placeholder="Sets" aria-label="Search"style="background-color: transparent; color: white; width:20%; border-bottom:1px solid white; display: inline;"><input  class="form-control form-control-sm ml-3 " type="number"placeholder="Reps" aria-label="Search"style="background-color: transparent; color: white; width:20%; border-bottom:1px solid white; display: inline;"> &emsp14;<a onclick="" class="btn btn-primary btn-primary"style=" border-radius: 10px;display: inline; background-color: #4f98ca; color: white; border: 1px solid #4f98ca;">Add</a></form></td></tr><hr class="featurette-divider"><br/></tr>'
                            }
                        }
                        if (query.length <= 0) {
                            $('#noResults').removeClass()
                        }
                        let displayResults = await $('#items').css('display', '');
                    }
                } catch (error) {
                    $('#errorText').removeClass()
                    console.log(error);
                }
            }
            else {
                $('#errorText').removeClass()
                let clearResults = document.getElementById('items').innerHTML = ''
                }
        }
        
        getExersises.search = search;
    }
    $('#searchForm').on('submit', function (e) {
        e.preventDefault();
    })
    getExersises()
</script>
{%endblock content%}